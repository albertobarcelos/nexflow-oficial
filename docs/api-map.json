{
  "meta": {
    "project": "NextFlow CRM",
    "version": "0.1.0",
    "lastUpdated": "2025-11-14T12:00:00Z"
  },
  "layoutConfig": {
    "description": "Layout responsivo com espaçamento uniforme e hierarquia preservada",
    "minSpacingCm": 1.5,
    "groupRadiusFactor": 0.26,
    "endpointRadiusFactor": 0.20,
    "flowRadiusFactor": 0.44,
    "textSizePx": 12
  },
  "groups": [
    { "id": "group:auth", "label": "Auth Supabase" },
    { "id": "group:rest", "label": "PostgREST" },
    { "id": "group:edge", "label": "Edge Functions" },
    { "id": "group:storage", "label": "Storage" },
    { "id": "group:external", "label": "APIs Externas" }
  ],
  "flows": [
    { "id": "flow:crm-login", "label": "Login CRM" },
    { "id": "flow:reseller-login", "label": "Login Revendedor" },
    { "id": "flow:set-password", "label": "Definir Senha" },
    { "id": "flow:document-upload", "label": "Upload de Documento" },
    { "id": "flow:sidebar", "label": "Carregar Sidebar" },
    { "id": "flow:location", "label": "Localização" },
    { "id": "flow:cep-lookup", "label": "Consulta CEP" },
    { "id": "flow:cnpj-lookup", "label": "Consulta CNPJ" }
  ],
  "nodes": [
    { "id": "endpoint:auth:token", "label": "Login (token)", "url": "/auth/v1/token?grant_type=password", "group": "group:auth", "methods": [ { "method": "POST", "status": [200, 401, 429] } ], "critical": true },
    { "id": "endpoint:auth:user", "label": "Usuário atual", "url": "/auth/v1/user", "group": "group:auth", "methods": [ { "method": "GET", "status": [200, 401] } ] },
    { "id": "endpoint:auth:logout", "label": "Logout", "url": "/auth/v1/logout", "group": "group:auth", "methods": [ { "method": "POST", "status": [200, 204] } ] },

    { "id": "endpoint:rest:core_client_users", "label": "core_client_users", "url": "/rest/v1/core_client_users", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:core_reseller_users", "label": "core_reseller_users", "url": "/rest/v1/core_reseller_users", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_companies", "label": "web_companies", "url": "/rest/v1/web_companies", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_people", "label": "web_people", "url": "/rest/v1/web_people", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_deals", "label": "web_deals", "url": "/rest/v1/web_deals", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_tasks", "label": "web_tasks", "url": "/rest/v1/web_tasks", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]}, {"method":"DELETE","status":[204]} ] },
    { "id": "endpoint:rest:web_funnels", "label": "web_funnels", "url": "/rest/v1/web_funnels", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_funnel_stages", "label": "web_funnel_stages", "url": "/rest/v1/web_funnel_stages", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:web_states", "label": "web_states", "url": "/rest/v1/web_states", "group": "group:rest", "methods": [ {"method":"GET","status":[200]} ] },
    { "id": "endpoint:rest:web_cities", "label": "web_cities", "url": "/rest/v1/web_cities", "group": "group:rest", "methods": [ {"method":"GET","status":[200]} ] },
    { "id": "endpoint:rest:licenses", "label": "licenses", "url": "/rest/v1/licenses", "group": "group:rest", "methods": [ {"method":"POST","status":[201]}, {"method":"GET","status":[200]} ] },
    { "id": "endpoint:rest:collaborators", "label": "collaborators", "url": "/rest/v1/collaborators", "group": "group:rest", "methods": [ {"method":"POST","status":[201]}, {"method":"GET","status":[200]} ] },
    { "id": "endpoint:rest:partners", "label": "partners", "url": "/rest/v1/partners", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"PUT","status":[200]} ] },
    { "id": "endpoint:rest:clients", "label": "clients", "url": "/rest/v1/clients", "group": "group:rest", "methods": [ {"method":"PUT","status":[200]}, {"method":"GET","status":[200]} ] },
    { "id": "endpoint:rest:deal_people", "label": "deal_people", "url": "/rest/v1/deal_people", "group": "group:rest", "methods": [ {"method":"GET","status":[200]}, {"method":"POST","status":[201]}, {"method":"DELETE","status":[204]} ] },
    { "id": "endpoint:rest:deal_history", "label": "deal_history", "url": "/rest/v1/deal_history", "group": "group:rest", "methods": [ {"method":"GET","status":[200]} ] },

    { "id": "endpoint:edge:upload-document", "label": "upload-document", "url": "/functions/v1/upload-document", "group": "group:edge", "methods": [ {"method":"POST","status":[200, 400, 401, 500]} ], "critical": true },
    { "id": "endpoint:edge:send-invite", "label": "send-invite", "url": "/functions/v1/send-invite", "group": "group:edge", "methods": [ {"method":"POST","status":[200, 202, 400, 500]} ], "critical": true },
    { "id": "endpoint:edge:verify-invite", "label": "verify-invite", "url": "/functions/v1/verify-invite", "group": "group:edge", "methods": [ {"method":"POST","status":[200, 400, 401]} ], "critical": true },

    { "id": "endpoint:storage:client-documents", "label": "client-documents", "url": "/storage/v1/object/client-documents/{path}", "group": "group:storage", "methods": [ {"method":"DELETE","status":[200, 404, 401]} ] },

    { "id": "endpoint:external:viacep", "label": "ViaCEP", "url": "https://viacep.com.br/ws/{cep}/json/", "group": "group:external", "methods": [ {"method":"GET","status":[200, 400, 404]} ] },
    { "id": "endpoint:external:brasilapi", "label": "BrasilAPI CNPJ", "url": "https://brasilapi.com.br/api/cnpj/v1/{cnpj}", "group": "group:external", "methods": [ {"method":"GET","status":[200, 404]} ] },
    { "id": "endpoint:external:receitaws", "label": "ReceitaWS CNPJ", "url": "https://www.receitaws.com.br/v1/cnpj/{cnpj}", "group": "group:external", "methods": [ {"method":"GET","status":[200, 404, 429]} ] },
    { "id": "endpoint:external:cnpjws", "label": "CNPJ.ws", "url": "https://www.cnpj.ws/cnpj/{cnpj}", "group": "group:external", "methods": [ {"method":"GET","status":[200, 404]} ] }
  ],
  "links": [
    { "source": "flow:crm-login", "target": "endpoint:auth:token", "label": "Autenticar", "method": "POST" },
    { "source": "flow:crm-login", "target": "endpoint:auth:user", "label": "Perfil", "method": "GET" },
    { "source": "flow:crm-login", "target": "endpoint:rest:core_client_users", "label": "Buscar colaborador", "method": "GET" },
    { "source": "flow:crm-login", "target": "endpoint:rest:web_funnels", "label": "Listar funis", "method": "GET" },
    { "source": "flow:crm-login", "target": "endpoint:rest:web_deals", "label": "Listar oportunidades", "method": "GET" },

    { "source": "flow:reseller-login", "target": "endpoint:auth:token", "label": "Autenticar", "method": "POST" },
    { "source": "flow:reseller-login", "target": "endpoint:rest:core_reseller_users", "label": "Validar acesso", "method": "GET" },
    { "source": "flow:reseller-login", "target": "endpoint:rest:core_reseller_users", "label": "Atualizar último login", "method": "PUT" },

    { "source": "flow:set-password", "target": "endpoint:edge:verify-invite", "label": "Validar convite", "method": "POST", "critical": true },

    { "source": "flow:document-upload", "target": "endpoint:edge:upload-document", "label": "Upload", "method": "POST", "critical": true },
    { "source": "flow:document-upload", "target": "endpoint:rest:clients", "label": "Atualizar documentos", "method": "PUT" },
    { "source": "flow:document-upload", "target": "endpoint:storage:client-documents", "label": "Remover documento", "method": "DELETE" },

    { "source": "flow:sidebar", "target": "endpoint:rest:core_client_users", "label": "Obter client_id", "method": "GET" },
    { "source": "flow:sidebar", "target": "endpoint:rest:web_funnels", "label": "Listar funis", "method": "GET" },

    { "source": "flow:location", "target": "endpoint:rest:web_states", "label": "Listar estados", "method": "GET" },
    { "source": "flow:location", "target": "endpoint:rest:web_cities", "label": "Listar cidades", "method": "GET" },

    { "source": "flow:cep-lookup", "target": "endpoint:external:viacep", "label": "ViaCEP", "method": "GET" },
    { "source": "flow:cnpj-lookup", "target": "endpoint:external:brasilapi", "label": "BrasilAPI", "method": "GET" },
    { "source": "flow:cnpj-lookup", "target": "endpoint:external:receitaws", "label": "ReceitaWS", "method": "GET" },
    { "source": "flow:cnpj-lookup", "target": "endpoint:external:cnpjws", "label": "CNPJ.ws", "method": "GET" }
  ]
  ,
  "layout": {
    "units": "px",
    "canvas": { "width": 2400, "height": 1350, "background": "#ffffff" },
    "groups": {
      "group:auth": { "cx": 540, "cy": 660, "r": 180 },
      "group:rest": { "cx": 1200, "cy": 780, "r": 540 },
      "group:edge": { "cx": 1980, "cy": 660, "r": 180 },
      "group:storage": { "cx": 840, "cy": 1080, "r": 140 },
      "group:external": { "cx": 1560, "cy": 1080, "r": 220 }
    },
    "flows": {
      "flow:crm-login": { "x": 300, "y": 180 },
      "flow:reseller-login": { "x": 540, "y": 180 },
      "flow:set-password": { "x": 780, "y": 180 },
      "flow:document-upload": { "x": 1020, "y": 180 },
      "flow:sidebar": { "x": 1260, "y": 180 },
      "flow:location": { "x": 1500, "y": 180 },
      "flow:cep-lookup": { "x": 1740, "y": 180 },
      "flow:cnpj-lookup": { "x": 1980, "y": 180 }
    },
    "nodes": {
      "endpoint:auth:token": { "x": 540, "y": 520 },
      "endpoint:auth:user": { "x": 661.2, "y": 730 },
      "endpoint:auth:logout": { "x": 418.8, "y": 730 },

      "endpoint:rest:core_client_users": { "x": 1200, "y": 280 },
      "endpoint:rest:core_reseller_users": { "x": 1493.9, "y": 375.5 },
      "endpoint:rest:web_companies": { "x": 1675.6, "y": 625.5 },
      "endpoint:rest:web_people": { "x": 1675.6, "y": 934.5 },
      "endpoint:rest:web_deals": { "x": 1493.9, "y": 1184.5 },
      "endpoint:rest:web_tasks": { "x": 1200, "y": 1280 },
      "endpoint:rest:web_funnels": { "x": 906.1, "y": 1184.5 },
      "endpoint:rest:web_funnel_stages": { "x": 724.4, "y": 934.5 },
      "endpoint:rest:web_states": { "x": 724.4, "y": 625.5 },
      "endpoint:rest:web_cities": { "x": 906.1, "y": 375.5 },

      "endpoint:rest:licenses": { "x": 1200, "y": 460 },
      "endpoint:rest:collaborators": { "x": 1477.1, "y": 620 },
      "endpoint:rest:partners": { "x": 1477.1, "y": 940 },
      "endpoint:rest:clients": { "x": 1200, "y": 1100 },
      "endpoint:rest:deal_people": { "x": 922.9, "y": 940 },
      "endpoint:rest:deal_history": { "x": 922.9, "y": 620 },

      "endpoint:edge:upload-document": { "x": 1980, "y": 520 },
      "endpoint:edge:send-invite": { "x": 2101.2, "y": 730 },
      "endpoint:edge:verify-invite": { "x": 1858.8, "y": 730 },

      "endpoint:storage:client-documents": { "x": 840, "y": 1080 },

      "endpoint:external:viacep": { "x": 1560, "y": 920 },
      "endpoint:external:brasilapi": { "x": 1720, "y": 1080 },
      "endpoint:external:receitaws": { "x": 1560, "y": 1240 },
      "endpoint:external:cnpjws": { "x": 1400, "y": 1080 }
    }
  }
}